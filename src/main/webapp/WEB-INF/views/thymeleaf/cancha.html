<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Detalle de Cancha</title>

    <link
      rel="stylesheet"
      th:href="@{/webjars/bootstrap/5.2.0/css/bootstrap.min.css}"
    />
    <link rel="stylesheet" th:href="@{/css/main.css}" />
    <link rel="stylesheet" th:href="@{/css/detalle-partido.css}" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=location_on,schedule,paid"
    />
  </head>

  <body>
    <!-- Navbar -->
    <div th:replace="~{fragments/navbar :: navbar}"></div>

    <main role="main" class="container" style="padding-top: 135px">
      <!-- Mensajes de error o éxito -->
      <div
        th:if="${error != null && cancha == null}"
        class="alert alert-danger text-center"
        id="alertError"
      >
        <h4 th:text="${error}">La cancha solicitada no existe.</h4>
      </div>
      <div
        th:if="${success != null}"
        id="alertSuccess"
        class="alert alert-success text-center"
        th:text="${success}"
      ></div>

      <!-- Contenido principal -->
      <div
        th:if="${cancha != null}"
        class="container d-flex flex-column justify-content-center width-100"
      >
        <!-- Título -->
        <div class="mainbox width-100" style="margin-top: 50px">
          <div class="d-flex flex-column align-items-center mb-4">
            <h1
              class="w-100 mb-2 text-center"
              th:text="${cancha.nombre}"
              style="margin: 0 !important"
            ></h1>
            <h4
              id="direccion-cancha"
              class="w-100 d-flex align-items-center justify-content-center gap-2"
            >
              <span class="material-symbols-outlined"></span>
              <span th:text="${cancha.direccion}"></span>
            </h4>
          </div>
          <hr class="colorgraph" />
        </div>

        <!-- Mapa + Detalles -->
        <div
          id="contendor-mapa-detalle"
          class="d-flex flex-row flex-wrap align-items-center justify-content-center"
        >
          <iframe
            id="map-iframe"
            frameborder="0"
            allowfullscreen
            th:if="${cancha != null}"
            th:src="'https://www.google.com/maps/embed/v1/place?key=AIzaSyCB2Jsk_wlMEsQ5phtgegFGXuNTlHB7YNY&q=' + ${#strings.replace(cancha.direccion, ' ', '+')}"
          ></iframe>

          <div id="contenedor-detalle">
            <div id="contenedor-detalle-info">
              <div class="w-100 mb-2">
                <strong>Zona:</strong>
                <span th:text="${cancha.zona}"></span>
              </div>

              <div class="detalle-columna">
                <div class="w-100">
                  <strong>Tipo de suelo:</strong>
                  <span th:text="${cancha.tipoSuelo}"></span>
                </div>
                <div class="w-100">
                  <strong>Capacidad:</strong>
                  <span th:text="${cancha.capacidad}"></span>
                </div>
              </div>

              <div class="w-100 mt-2">
                <strong>
                  <span class="material-symbols-outlined align-middle"
                    ></span
                  >
                  Precio por hora:
                </strong>
                <span th:text="${cancha.precio}"></span>
              </div>
            </div>

            <div
              id="contenedor-detalle-acciones"
              class="d-flex flex-column justify-content-center align-items-center mt-4 gap-1"
            >
              <a
                th:href="@{/canchas-disponibles}"
                class="btn btn-primary w-100"
              >
                Volver a la lista de canchas
              </a>
            </div>
          </div>
        </div>

        <!-- Listado de horarios -->
        <div id="contenedor-participantes" class="mt-5">
          <h2 class="participantes-titulo">Horarios disponibles</h2>
          <hr class="colorgraph" />

          <div th:if="${#lists.isEmpty(horarios)}" class="text-muted">
            No hay horarios disponibles.
          </div>

          <ul
            class="list-group"
            th:if="${!#lists.isEmpty(horarios)}"
          >
            <li
              class="list-group-item d-flex justify-content-between align-items-center"
              th:each="horario : ${horarios}"
            >
              <div>
                <strong th:text="${horario.diaSemana}"></strong>:
                <span th:text="${horario.horaInicio}"></span> -
                <span th:text="${horario.horaFin}"></span>
              </div>
              <div>
                <button
                  th:if="${horario.disponible}"
                  class="btn btn-success btn-sm"
                  th:onclick="'location.href=\'/spring/reserva/nueva?usuarioId=' + ${usuarioId} + '&horarioId=' + ${horario.id} + '\';'"
                >
                  Reservar
                </button>
                <button
                  th:if="${!horario.disponible}"
                  class="btn btn-secondary btn-sm"
                  disabled
                >
                  No disponible
                </button>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </main>

    <script
      type="text/javascript"
      th:src="@{/webjars/bootstrap/5.2.0/js/bootstrap.min.js}"
    ></script>
    <script type="module" th:src="@{/js/common.js}"></script>
  </body>
</html>