<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>Perfil de usuario a ver</title>

    <!-- Bootstrap core CSS -->
    <link
            rel="stylesheet"
            th:href="@{/webjars/bootstrap/5.2.0/css/bootstrap.min.css}"
    />
    <link rel="stylesheet" th:href="@{/css/main.css}" />
    <link rel="stylesheet" th:href="@{/css/perfil.css}" />

</head>

<body>

<div th:replace="~{fragments/navbar :: navbar}"></div>


<div class="profile-header">
    <div class="profile-avatar"></div>
</div>


<main role="main" class="container">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="card shadow profile-card">
                <div class="card-header">
                    <h4 class="mb-0" th:text="${usuarioAVer.nombre + ' ' + usuarioAVer.apellido}">Nombre Apellido</h4>
                    <small th:text="${usuarioAVer.email}">email@ejemplo.com</small>
                </div>
                <div class="card-body">
                    <p>
                        <strong>Nombre:</strong>
                        <span th:text="${usuarioAVer.nombre}"></span>
                    </p>
                    <p>
                        <strong>Apellido:</strong>
                        <span th:text="${usuarioAVer.apellido}"></span>
                    </p>
                    <p>
                        <strong>Email:</strong>
                        <span th:text="${usuarioAVer.email}"></span>
                    </p>
                    <p>
                        <strong>Posición favorita:</strong>
                        <span th:text="${usuarioAVer.posicionFavorita}"></span>
                    </p>
                </div>


                <div th:if="${estadoAmistad?.name() == 'ACEPTADA'}">
                    <button class="btn btn-secondary btn-lg" disabled>Ya son amigos </button>
                </div>

                <!-- cuando se envia la solicitiud -->
                <div th:if="${amistad != null and estadoAmistad?.name() == 'PENDIENTE'}">
                    <!-- Si yo mando la solicitud -->
                    <div th:if="${amistad.usuario1 != null and amistad.usuario1.id == usuarioActual.id}">
                        <button class="btn btn-outline-warning btn-lg" disabled>Solicitud enviada </button>
                    </div>

                    <!-- parte receptor -->
                    <div th:if="${amistad.usuario2 != null and amistad.usuario2.id == usuarioActual.id}">
                        <form style="display:inline;">
                            <button type="submit" class="btn btn-success btn-lg">Aceptar solicitud</button>
                        </form>
                        <form style="display:inline;">
                            <button type="submit" class="btn btn-danger btn-lg">Rechazar solicitud</button>
                        </form>
                    </div>
                </div>

                <!-- sin amistad -->
                <div th:if="${amistad == null}">
                    <form th:action="@{/perfil/amistad/enviar/{idReceptor}(idReceptor=${usuarioAVer.id})}" method="post">
                        <button type="submit" class="btn btn-success btn-lg">Añadir amigo</button>
                    </form>
                </div>

            </div>
        </div>
    </div>
</main>
<script
        type="text/javascript"
        th:src="@{/webjars/bootstrap/5.2.0/js/bootstrap.bundle.min.js}"
></script>
</body>
</html>
